{"version":3,"sources":["components/scans/components/common/Message.js","assets/ico/003-fingerprint-2.svg","components/scans/components/chkinout/arePoints.js","components/scans/components/chkinout/ScanInOutList.js","components/scans/components/common/ScanInOut.js","components/scans/components/chkinout/ScanInOut.js","components/scans/containers/ScanInOut.js","managers/AuthService.js","components/scans/ErrorPage.js","components/scans/components/common/profile.js"],"names":["Message","props","className","style","marginBottom","alert","msg","module","exports","arePointsNear","checkPoint","centerPoint","km","ky","kx","Math","cos","PI","lat","dx","abs","lng","dy","sqrt","geolocated","positionOptions","enableHighAccuracy","maximumAge","timeout","Infinity","userDecisionTimeout","useState","qrscan","setQrscan","useEffect","show","isGeolocationAvailable","isGeolocationEnabled","coords","textAlign","delay","onError","err","console","error","onScan","e","data","undefined","obj","JSON","parse","log","arePoints","latitude","longitude","confirm","scan_id","handleScan","toFixed","width","marginTop","parseFloat","ScanInOut","padding","type","onClick","src","memberchkinout","alt","marginRight","marginLeft","paddingBottom","dispatch","useDispatch","Auth","AuthService","setMsg","setShow","loggedIn","isshow","location","status","userId","getProfile","id","checkType","scanId","Promise","resolve","reject","createMsg","a","createScanInOut","then","res","setTimeout","window","replace","reload","catch","ErrorPage","this","getToken","jwt","sign","localStorage","setItem","getItem","decode","minHeight","to","profile","name"],"mappings":"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","file":"static/js/12.fa9a07ec.chunk.js","sourcesContent":["import React from \"react\";\n\nconst Message = (props) => {\n  return (\n    <div className=\"row\" style={{ marginBottom: 10 }}>\n      <div className=\"col-12\">\n        <div className={`${props.alert} alert-dismissible`}>\n          <h5>แจ้งเตือน !</h5>\n          {props.msg}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Message;\n","module.exports = __webpack_public_path__ + \"static/media/003-fingerprint-2.2e6dfe5e.svg\";","function arePointsNear(checkPoint, centerPoint, km) {\n  var ky = 40000 / 360;\n  var kx = Math.cos((Math.PI * centerPoint.lat) / 180.0) * ky;\n  var dx = Math.abs(centerPoint.lng - checkPoint.lng) * kx;\n  var dy = Math.abs(centerPoint.lat - checkPoint.lat) * ky;\n\n  // console.log(dx * dx + dy * dy);\n  return Math.sqrt(dx * dx + dy * dy) <= km;\n}\n\nexport default arePointsNear;\n","import React, { useState, useEffect } from \"react\";\nimport arePoints from \"./arePoints\";\nimport QrReader from \"react-qr-reader\";\nimport { geolocated } from \"react-geolocated\";\nimport ScanInOutMessage from \"../common/Message\";\n\nimport \"react-toastify/dist/ReactToastify.css\";\nconst ScanInOutList = (props) => {\n  const [qrscan, setQrscan] = useState([]);\n\n  const handleScan = (data, lat, lng) => {\n    if (data !== null && data !== undefined) {\n      var obj = JSON.parse(data);\n      setQrscan(obj);\n      console.log(obj);\n      arePoints(\n        {\n          lat: lat,\n          lng: lng\n        },\n        {\n          lat: obj.latitude,\n          lng: obj.longitude\n        },\n        0.2\n      )\n        ? props.confirm(props.msg, false, obj.scan_id, true)\n        : props.confirm(props.msg, true, \"\", false);\n    }\n  };\n\n  const handleError = (err) => {\n    console.error(err);\n  };\n\n  useEffect(() => {}, [props.show, props.msg]);\n\n  return props.msg === \"chkin\" || props.msg === \"chkout\" ? (\n    !props.isGeolocationAvailable ? (\n      <ScanInOutMessage\n        msg=\"--- เบราว์เซอร์ของคุณไม่รองรับ แนะนำ Chome---\"\n        alert=\"alert alert-warning\"\n      />\n    ) : !props.isGeolocationEnabled ? (\n      <div>\n        <ScanInOutMessage\n          msg=\"--- กรุณาเปิด GPS มือถือของท่าน &hellip; ---\"\n          alert=\"alert alert-warning\"\n        />\n      </div>\n    ) : props.coords ? (\n      <>\n        <div className=\"row\">\n          <div className=\"col-12\" style={{ textAlign: \"center\" }}>\n            {/* {props.coords.latitude.toFixed(4)} ||{\" \"}\n            {qrscan !== undefined ? parseFloat(qrscan.latitude).toFixed(4) : 0}\n            <br />\n            {props.coords.longitude.toFixed(4)} ||{\" \"}\n            {qrscan !== undefined ? parseFloat(qrscan.longitude).toFixed(4) : 0}\n            <br /> */}\n            {props.show ? (\n              <QrReader\n                delay={300}\n                onError={handleError}\n                onScan={(e) =>\n                  handleScan(\n                    e,\n                    props.coords.latitude.toFixed(4),\n                    props.coords.longitude.toFixed(4)\n                  )\n                }\n                style={{ width: \"100%\" }}\n                // style={{ width: \"200px\", heigth: \"200px\" }}\n              />\n            ) : (\n              \"\"\n            )}\n          </div>\n        </div>\n\n        <div className=\"row\" style={{ marginTop: 10 }}>\n          {arePoints(\n            {\n              lat: props.coords.latitude.toFixed(4),\n              lng: props.coords.longitude.toFixed(4)\n            },\n            {\n              lat:\n                qrscan !== undefined\n                  ? parseFloat(qrscan.latitude).toFixed(4)\n                  : 0,\n              lng:\n                qrscan !== undefined\n                  ? parseFloat(qrscan.longitude).toFixed(4)\n                  : 0\n            },\n            0.3\n          ) ? (\n            <div className=\"col-12\">\n              {props.show ? (\n                <ScanInOutMessage\n                  msg=\"---  ระยะห่างจากจุดสแกน ไม่เกิน 100 เมตร &hellip;---\"\n                  alert=\"alert alert-warning\"\n                />\n              ) : (\n                <ScanInOutMessage\n                  msg=\"บันทึกข้อมูลลงเวลาเรียบร้อย\"\n                  alert=\"alert alert-success\"\n                />\n              )}\n            </div>\n          ) : (\n            <div className=\"col-12\" style={{ textAlign: \"center\" }}>\n              <ScanInOutMessage\n                msg=\"---  ระยะห่างจากจุดสแกน ไม่เกิน 100 เมตร &hellip; ---\"\n                alert=\"alert alert-warning\"\n              />\n            </div>\n          )}\n        </div>\n      </>\n    ) : (\n      <div className=\"col-12\" style={{ textAlign: \"center\" }}>\n        <ScanInOutMessage\n          msg=\"--- กำลังค้นหาตำแหน่ง &hellip; ---\"\n          alert=\"alert alert-info\"\n        />\n      </div>\n    )\n  ) : (\n    <div className=\"row\">\n      <div className=\"col-12\" style={{ textAlign: \"center\" }}>\n        <ScanInOutMessage\n          msg=\"--- กด สแกนเข้า - ออก เพื่อทำการสแกน ---\"\n          alert=\"alert alert-info\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default geolocated({\n  positionOptions: {\n    enableHighAccuracy: true,\n    maximumAge: 100,\n    timeout: Infinity\n  },\n  userDecisionTimeout: 5000\n})(ScanInOutList);\n","import React from \"react\";\nimport memberchkinout from \"../../../../assets/ico/003-fingerprint-2.svg\";\n\nfunction ScanInOut(props) {\n  return (\n    <div className=\"card-header\">\n      <div className=\"row\">\n        <div className=\"col-md-6 col-12\" style={{ padding: 2 }}>\n          <button\n            type=\"submit\"\n            className=\"btn btn-default btn-lg btn-block\"\n            onClick={() => props.confirm(\"chkin\", true)}\n          >\n            <img\n              src={memberchkinout}\n              alt=\"memberchk in\"\n              style={{\n                width: 50,\n                marginRight: 5,\n                marginLeft: -7,\n                paddingBottom: 2\n              }}\n            />\n            <p>สแกนเข้า</p>\n          </button>\n        </div>\n        <div className=\"col-md-6 col-12\" style={{ padding: 2 }}>\n          <button\n            type=\"submit\"\n            className=\"btn btn-default btn-lg btn-block\"\n            onClick={() => props.confirm(\"chkout\", true)}\n          >\n            <img\n              src={memberchkinout}\n              alt=\"memberchk out\"\n              style={{\n                width: 50,\n                marginRight: 5,\n                marginLeft: -7,\n                paddingBottom: 2\n              }}\n            />\n            <p>สแกนออก</p>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ScanInOut;\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\n// Component\nimport ScanInOutList from \"./ScanInOutList\";\nimport SearchMember from \"../common/ScanInOut\";\n// Action\nimport { createScanInOut } from \"../../../../reduxs/actions/ScanInOut\";\n// LocalStore\n\nimport AuthService from \"../../../../managers/AuthService\";\nimport { profile as Profile } from \"../common/profile\";\nimport ErrorPage from \"../../ErrorPage\";\nfunction ScanInOut() {\n  const dispatch = useDispatch();\n  const Auth = new AuthService(\"http://localhost:3000/\");\n\n  const [msg, setMsg] = useState(\"\");\n  const [show, setShow] = useState(false);\n  // Confirm From Search\n  const onConfirm = (msg, isshow) => {\n    console.log(isshow);\n    console.log(msg);\n    setMsg(msg);\n    setShow(isshow);\n  };\n\n  const onConfirmScan = (msg, isshow, location, status) => {\n    console.log(status);\n    console.log(msg);\n    setMsg(msg);\n    setShow(isshow);\n    // Scan success\n    if (status) {\n      const data = {\n        userId: Auth.getProfile().id,\n        checkType: msg === \"chkin\" ? \"0\" : \"1\",\n        scanId: location\n      };\n\n      // dispatch(createScanInOut(data));\n\n      let Create = new Promise(function (resolve, reject) {\n        async function createMsg() {\n          return await dispatch(createScanInOut(data)).then((res) => {\n            // console.log(res);\n            return res[0].msg;\n          });\n        }\n        // get result by function\n        (async function () {\n          let resStatus = await createMsg();\n          if (resStatus === \"created successful\") {\n            resolve(true);\n          } else {\n            reject(false);\n          }\n        })();\n      });\n\n      // promiss status and msg\n      Create.then((status) => {\n        status\n          ? setTimeout(() => {\n              window.location.replace(\"/rehscan/#/scan/member-list\");\n            }, 500)\n          : setTimeout(() => {\n              window.location.reload();\n            }, 500);\n      }).catch((e) => {\n        setTimeout(() => {\n          window.location.reload();\n        }, 500);\n      });\n    }\n  };\n\n  useEffect(() => {}, []);\n\n  return Auth.loggedIn() ? (\n    <section className=\"content\" style={{ marginTop: -16 }}>\n      <div className=\"container-fluid\">\n        <Profile />\n        <div className=\"card\">\n          <SearchMember confirm={onConfirm} />\n          <div className=\"card-body\">\n            <ScanInOutList msg={msg} show={show} confirm={onConfirmScan} />\n          </div>\n        </div>\n      </div>\n    </section>\n  ) : (\n    <ErrorPage />\n  );\n}\n\nexport default ScanInOut;\n","import React from \"react\";\nimport ScanComponent from \"../components/chkinout/ScanInOut\";\nfunction ScanInOut() {\n  return (\n    <div>\n      <ScanComponent />\n    </div>\n  );\n}\n\nexport default ScanInOut;\n","import decode from \"jwt-decode\";\nimport sign from \"jwt-encode\";\n\nexport default class AuthService {\n  loggedIn() {\n    // Checks if there is a saved token and it's still valid\n    const token = this.getToken(); // GEtting token from localstorage\n    return !!token; // handwaiving here\n  }\n\n  setToken(data) {\n    const secret = \"secret\";\n    const jwt = sign(data, secret);\n    // Saves user token to localStorage\n    localStorage.setItem(\"id_token\", jwt);\n  }\n  getToken() {\n    // Retrieves the user token from localStorage\n    return localStorage.getItem(\"id_token\");\n  }\n  getProfile() {\n    // Using jwt-decode npm package to decode the token\n    return decode(this.getToken());\n  }\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nconst ErrorPage = () => {\n  return (\n    <div className=\"content-wrapper\" style={{ minHeight: 2836 }}>\n      {/* Main content */}\n      <section className=\"content\">\n        <div className=\"error-page\">\n          <h2 className=\"headline text-warning\"> 404</h2>\n          <div className=\"error-content\">\n            <h3>\n              <i className=\"fas fa-exclamation-triangle text-warning\" />{\" \"}\n              แจ้งเตือน ! . กรุณาเข้าสู่ระบบ\n            </h3>\n            <p>\n              <Link to=\"/scan/member-register\">คลิกเพื่อเข้าสู่ระบบ</Link>\n            </p>\n          </div>\n          {/* /.error-content */}\n        </div>\n        {/* /.error-page */}\n      </section>\n      {/* /.content */}\n    </div>\n  );\n};\n\nexport default ErrorPage;\n","import React from \"react\";\nimport AuthService from \"../../../../managers/AuthService\";\nexport const profile = () => {\n  const Auth = new AuthService(\"http://localhost:3000/\");\n  return (\n    <div className=\"row\">\n      <div className=\"col-12\">\n        <div className=\"card\">\n          <div className=\"card-body\" style={{ textAlign: \"center\" }}>\n            <span className=\"text-muted\">\n              <i className=\"fas fa-user\" />{\" \"}\n              {!Auth.loggedIn() ? \"\" : Auth.getProfile().name}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"sourceRoot":""}